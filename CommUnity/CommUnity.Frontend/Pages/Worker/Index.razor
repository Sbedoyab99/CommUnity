@page "/actions/{ResidentialUnitId:int}"

<MudGrid>
    <MudItem xs="12" sm="6">
        <MudPaper>
            <MudTable Items="@visitors"
                      @ref="table"
                      ServerData="@(new Func<TableState, Task<TableData<VisitorEntry>>>(LoadVisitorsAsync))"
                      Dense="true"
                      Hover="true"
                      Striped="true"
                      FixedHeader="true"
                      FixedFooter="true">
                <ToolBarContent>
                    <MudText Typo="Typo.h6" Class="mr-4"><MudIcon Icon="@Icons.Material.Filled.People"/> Visitantes</MudText>
                    <MudSpacer />
                    <MudSelect T="VisitorStatus" Value="Status" ValueChanged="ChangedValue">
                        <MudSelectItem Value="VisitorStatus.Scheduled">Programado</MudSelectItem>
                        <MudSelectItem Value="VisitorStatus.Approved">Aprobado</MudSelectItem>
                        <MudSelectItem Value="VisitorStatus.Canceled">Cancelado</MudSelectItem>
                    </MudSelect>
                </ToolBarContent>
                <HeaderContent>
                    <MudTh>Nombre</MudTh>
                    <MudTh>Placa</MudTh>
                    <MudTh>Fecha</MudTh>
                    <MudTh>Estado</MudTh>
                    <MudTh>Acciones</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Nombre">@context.Name</MudTd>
                    <MudTd DataLabel="Placa">@context.Plate</MudTd>
                    <MudTd DataLabel="Fecha"> @context.DateTime.ToString("dd/MM/yyyy") </MudTd>
                    <MudTd DataLabel="Estado"> @context.Status </MudTd>
                    <MudTd DataLabel="Acciones">
                        @if (context.Status == VisitorStatus.Scheduled)
                        {
                            <MudButton Variant="Variant.Outlined" EndIcon="@Icons.Material.Filled.Check" Color="Color.Success" OnClick="@(()=> ConfirmVisitorEntry(@context))">Confirmar</MudButton>
                        }
                        else if (context.Status == VisitorStatus.Approved)
                        {
                            <MudText Typo="Typo.body2" Color="Color.Inherit">No hay acciones disponibles</MudText>
                        }
                    </MudTd>
                </RowTemplate>
                <NoRecordsContent>
                    <MudText>No se encontraron registros.</MudText>
                </NoRecordsContent>
                <PagerContent>
                    <MudTablePager RowsPerPageString="Numero de Registros:"
                                   PageSizeOptions="pageSizeOptions"
                                   AllItemsText="Todos" />
                </PagerContent>
            </MudTable>
        </MudPaper>
    </MudItem>
    <MudItem xs="12" sm="6">
        <MudPaper>
            <MudText>Registrar Correspondencia</MudText>           
        </MudPaper>
    </MudItem>       
</MudGrid>


